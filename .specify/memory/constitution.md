<!--
版本變更：v1.0.0 → v1.1.0
修改原則：無
新增原則：
- VI. 程式碼風格一致性（命名規範）
新增章節：無
修改章節：無
模板狀態：
✅ .specify/templates/plan-template.md 已檢查
✅ .specify/templates/spec-template.md 已檢查  
✅ .specify/templates/tasks-template.md 已檢查
⚠ CODE_STYLE.md 需同步新原則
✅ .specify/templates/plan-template.md 已更新版本參考
後續待辦：確保 CODE_STYLE.md 與憲章原則保持一致
-->

# Go 聊天室應用程式專案憲章

## 核心原則

### I. 領域驅動設計（DDD）架構

所有業務邏輯必須封裝在領域層；實體必須包含領域方法和業務規則；儲存庫介面定義在領域層，實作在基礎設施層；永遠回傳領域實體，不是資料庫模型。

**理由**：確保業務邏輯的純粹性和可測試性，避免基礎設施關注點污染業務邏輯。

### II. 事件驅動開發

系統採用事件驅動架構處理即時通訊；WebSocket 連接必須透過事件處理器管理；所有狀態變更必須透過事件傳播；使用背景處理器處理異步事件。

**理由**：支援即時聊天功能的高效能需求，確保系統的可擴展性和響應性。

### III. 四層架構分離（不可協商）

嚴格遵循領域層（domain/）、基礎設施層（infrastructure/）、展示層（server/）、元件層（component/）的分離；業務邏輯絕不放在處理器中；資料庫程式碼只能在基礎設施層；跨層依賴必須透過介面。

**理由**：維持架構清晰度，確保系統的可維護性和可測試性。

### IV. 依賴注入模式

所有服務使用建構子注入初始化；處理器透過全域設定接收服務依賴；避免使用全域變數（除了處理器設定）；測試時使用介面模擬。

**理由**：提供靈活的測試能力和鬆散耦合的系統設計。

### V. 繁體中文優先

所有文件、註解、錯誤訊息使用繁體中文；API 回應訊息使用繁體中文；程式碼變數和函式名稱使用英文；技術術語保持專業中文翻譯。

**理由**：確保專案的本地化品質和團隊溝通效率。

### VI. 程式碼風格一致性

變數命名：私有變數使用小駝峰式（camelCase），公開變數使用大駝峰式（PascalCase），常數使用全大寫加底線；函式命名：私有函式小駝峰式加動詞開頭，公開函式大駝峰式加動詞開頭，建構函式使用 `New` 前綴；類型命名：結構體大駝峰式加名詞，介面大駝峰式加 `er` 後綴，錯誤使用 `Err` 前綴。

**理由**：統一的程式碼風格是團隊協作的基石，確保程式碼的可讀性和一致性。

## 開發工作流程

Docker 容器化優先開發；使用 `docker-compose.yaml` 統一環境管理；支援本機開發和容器化部署雙模式；環境配置透過 YAML 檔案管理（development.yaml、production.yaml、test.yaml）；必須通過 `APP_ENV` 環境變數切換環境。

## 測試策略

測試環境隔離透過 `test.yaml` 配置；儲存庫介面支援模擬測試；所有業務邏輯必須有單元測試覆蓋；執行測試使用標準 Go 測試工具：`go test ./...`；測試覆蓋率檢查：`go test -cover ./...`。

## 治理規範

本憲章優先於所有其他開發實踐；所有 PR/程式碼審查必須驗證憲章合規性；架構變更需要文件化的合理說明；複雜度增加必須有明確的業務價值證明；使用 `.github/copilot-instructions.md` 作為開發指導文件。

**版本**：v1.1.0 | **制定日期**：2025-01-24 | **最後修訂**：2025-01-24
